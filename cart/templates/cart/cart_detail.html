{% extends 'base.html' %}
{% load static %}


{% block add_css %}
  <link rel="stylesheet" href="{% static 'cart/css/cart_css.css' %}" type="text/css" media="screen" />
{% endblock add_css %}


{% block content %}
    <!-- https://docs.djangoproject.com/en/4.0/ref/templates/builtins/ -->

    <div class="container " style="margin-top: 20%; margin-bottom:20%;">
      <div class="row">

      <div style="border: 1px solid; text-align:center;" class="col-lg-4 col-md-4">
        {% if user.is_authenticated %}
        <div class="">

            <span>قیمت کل {{cart.get_total_price}}</span>
            <a class="btn btn-dark" href="{% url 'orders:checkout' %}">خرید را نهایی کن</a>
        </div>
        {% else %}

          <a href="{% url 'account_login' %}">ابتدا وارد شوید</a>
        {% endif %}
      </div>
        <div class="col-lg-8 col-md-8">
          <table id="customers">
            <tr>
              <th>حذف از سبد</th>
              <th>تغییر دادن تعداد</th>
              <th>قیمت کلی</th>
              <th>تعداد</th>
              <th> قیمت هر واحد</th>
              <th>اسم کالا</th>
              <th>عکس</th>
            </tr>
            {% for item in cart %}
              {% with product=item.product %}
                <tr>
                  <td><a style="color:rgb(255, 99, 71); text-decoration:none;" href="{% url 'cart:cart_remove' product_id=product.id  %}">
                    <strong>حذف</strong>
                  </a></td>
                  <td><form class="" action="{% url 'cart:cart_add' product_id=product.id %}" method="post">
                    {{ item.update_quantity_form.quantity}}
                    {{ item.update_quantity_form.update }}
                    <input type="submit" name="" value="update">
                    {% csrf_token %}
                  </form></td>
                  <td>{{ item.total_price }}</td>
                  <td>{{ item.quantity }}</td>
                  <td>{{ item.price }}</td>
                  <td>{{product.name}}</td>
                  <td ><a href="{{ product.get_absolute_url }}"><img style="width:90px;" src="{{product.product_image.first.image.url}}" alt=""></a></td>
              </tr>
            {% endwith %}
          {% endfor %}
          </table>
        </div>

      </div>


    </div>


{% endblock %}
